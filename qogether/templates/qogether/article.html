{% extends 'qogether/base.html' %}
{% block content %}
{% load static %}
<link rel='stylesheet' href="{% static 'qogether/css/article.css' %}">

<h1 class="article_title">{{ article.title }} - <a href="{% url 'a_list' question.id %}">List</a> - {{ article.author.id }}</h1>
      {% if user.is_authenticated %}
        {% if user.id == article.author.id %}

<div class="article_edit_delete">
<a href="{% url 'update_article' article.pk %}">Edit</a>
- <a href="{% url 'delete_article' question.id article.pk %}">Delete</a>
        {% endif %}
      {% endif %}
<br>
published at : {{ article.pub_date }} by {{ article.author.first_name }} {{ article.author.last_name }} - {{ article.author.email }}

</div>

<div class="article_article">
{% if article.header_image %}
  <p><img src="{{ article.header_image.url }}" width=700></p><br>
{% endif %}
<p>{{ article.description|safe }}</p>
<p>tags : {{ article.article_tag }}</p>
</div>

<div class="article_profile">
<br><br>
{% if article.author.profile.profile_pic %}
<img src="{{ article.author.profile.profile_pic.url }}" width=100 height=100>
{% else %}
<img src="{% static 'qogether/images/default_profile_image.png' %}" width=100 height=100>
{% endif %}
<a href="{% url 'show_profile_page' article.author.profile.id %}">Profile Page</a> |
{% if article.author.profile.website_url %}
<a href="{{ article.author.profile.website_url }}">| Website</a>
{% endif %}
{% if article.author.profile.facebook_url %}
| <a href="{{ article.author.profile.facebook_url }}">Facebook</a>
{% endif %}
{% if article.author.profile.twitter_url %}
| <a href="{{ article.author.profile.twitter_url }}">Twitter</a>
{% endif %}
{% if article.author.profile.instagram_url %}
| <a href="{{ article.author.profile.instagram_url }}">Instagram</a>
{% endif %}
{% if article.author.profile.pinterest_url %}
| <a href="{{ article.author.profile.pinterest_url }}">Pinterest</a>
{% endif %}
<p>{{ article.author.profile.bio }}</p>
</div>

<div class="article_like">
<hr>
<br>
<form action="{% url 'like_article' article.pk %}" method="post">
  {% csrf_token %}
{% if user.is_authenticated %}
  {% if liked %}
  <button type="submit" name="article_id", value="{{ article.id }}">Unike</button>
  {% else %}
  <button type="submit" name="article_id", value="{{ article.id }}">Like</button>
  {% endif %}
{% else %}
<a href="{% url 'login' %}">Login to like</a>
{% endif %}
  - {{ total_likes }} Likes
</form>
</div>

<div class="article_comments">
<hr><br>
  <p class="lead">Comments</p>
  <form action="." method="post"> {% csrf_token %}
    {{ comment_form }}
    <input type="submit" value="Post comment" class=''>
  </form>
  {% for comment in comments %}
    <div class="">
    <blockquote>
      <hr>
      <p>{{ comment.content }}</p>
      <footer>by {{ comment.user }} | {{ comment.pub_date }} | {% if comment.children.count > 0 %}{{ comment.children.count }} Comment{% if comment.children.count > 1 %}s{% endif %} | {%endif %}<a class='comment-reply-btn' href="#">Reply</a></footer>
      <div class='comment-reply' style=''>
      <hr>
        {% for child_comment in comment.children %}
          <blockquote>
            <p>{{ child_comment.content }}</p>
            <footer>by {{ child_comment.user }} | {{ child_comment.pub_date }}</footer>
            <hr>
          </blockquote>
        {% endfor %}
        <form action="." method="post"> {% csrf_token %}
          {{ comment_form }}
          <input type="hidden" name="parent_id" value="{{ comment.id }}">
          <input type="submit" value="Reply" class=''>
        </form>
      </div>
    </blockquote>
    </div>
  {% endfor %}
<br><hr>
</div>


{% endblock %}
